% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_hotspots.R
\name{plot_hotspot_density_bin2d}
\alias{plot_hotspot_density_bin2d}
\title{Faceted hotspot vs non-hotspot density overlays (2D binned heatmaps)}
\usage{
plot_hotspot_density_bin2d(
  hotspots_df,
  inverse_df,
  socio_labels,
  which_layers = c("both", "hotspots", "nonhotspots"),
  drop_services = NULL,
  trim_p = c(0.01, 0.99),
  y_trim_p = NULL,
  bg_bins = 80,
  hs_bins = 50,
  bg_alpha = 0.7,
  hs_alpha = 0.95,
  bg_trans = "sqrt",
  hs_trans = "sqrt",
  bg_palette = NULL,
  hs_palette = NULL,
  single_palette = NULL,
  bg_palette_option = "C",
  hs_palette_option = "B",
  single_palette_option = "D",
  palette_n = 256,
  bg_reverse = FALSE,
  hs_reverse = FALSE,
  single_reverse = FALSE,
  bg_fill_limits = c(0.02, 0.98),
  hs_fill_limits = c(0.02, 0.98),
  single_fill_limits = c(0.02, 0.98),
  single_limits_mode = c("quantile", "absolute"),
  limits_mode = c("quantile", "absolute"),
  per_facet_stretch = FALSE,
  hs_contours = FALSE,
  hs_contour_color = "#222222",
  hs_contour_size = 0.25,
  out_dir = "output_charts",
  filename_suffix = "_two_scales_bin2d.png",
  run_id = NULL,
  overwrite = FALSE,
  width = 10,
  height = 6,
  dpi = 300,
  use_ragg = TRUE,
  hide_inline = TRUE,
  print_interactive = TRUE
)
}
\arguments{
\item{hotspots_df}{Data frame of hotspot rows (long format).}

\item{inverse_df}{Data frame of non-hotspot (complement) rows.}

\item{socio_labels}{Named character vector: raw socio var -> facet label.}

\item{which_layers}{One of "both","hotspots","nonhotspots".}

\item{drop_services}{Character vector of services to exclude in both inputs.}

\item{trim_p}{Length-2 numeric, pct_chg quantile trim per service (x-axis).}

\item{y_trim_p}{NULL or length-2 numeric, optional socio_val quantile trim per service (y-axis).}

\item{bg_bins, hs_bins}{Integer bin counts for non-hotspot / hotspot heatmaps.}

\item{bg_alpha, hs_alpha}{Opacity for each layer (0â€“1).}

\item{bg_trans, hs_trans}{Count transform for fill ("identity","sqrt","log10").}

\item{bg_palette, hs_palette, single_palette}{Color palettes (character vectors).
If \code{NULL}, palettes are generated from viridis options below.}

\item{bg_palette_option, hs_palette_option, single_palette_option}{Viridis options
("A"=magma,"B"=inferno,"C"=plasma,"D"=viridis,"E"=cividis). Used when the
corresponding \verb{*_palette} is \code{NULL}. Defaults: bg="C", hs="B", single="D".}

\item{palette_n}{Number of colors to generate when using viridis options.}

\item{bg_reverse, hs_reverse, single_reverse}{Reverse palettes?}

\item{bg_fill_limits, hs_fill_limits}{Length-2 numeric. If limits_mode="quantile",
values are quantiles in \link{0,1}; if "absolute", absolute count limits. Use NULL to auto.}

\item{single_fill_limits}{Length-2 numeric for single-layer stretch (same semantics).}

\item{single_limits_mode}{"quantile" or "absolute" for single-layer stretch.}

\item{limits_mode}{"quantile" or "absolute" for the two-layer ("both") case.}

\item{per_facet_stretch}{Logical. If TRUE, stretch per facet; else per service.}

\item{hs_contours}{Logical; if TRUE, draw hotspot \code{stat_density_2d} contours to
improve contrast. Guarded to only draw when enough points.}

\item{hs_contour_color, hs_contour_size}{Contour styling.}

\item{out_dir}{Output directory; created if missing.}

\item{filename_suffix}{File suffix for images.}

\item{run_id}{Optional tag stamped into filenames/caption (else timestamp).}

\item{overwrite}{If FALSE, makes a unique filename on collision.}

\item{width, height, dpi}{PNG size/resolution.}

\item{use_ragg}{Use ragg::agg_png device for reliability.}

\item{hide_inline}{Hide inline figures when knitting.}

\item{print_interactive}{Print plots when interactive and not knitting.}
}
\value{
Invisibly, character vector of written file paths.
}
\description{
Draw per-service, faceted 2D density overlays using \code{stat_bin2d}. You can:
\itemize{
\item plot both layers together (separate fill scales via ggnewscale), or
\item plot only hotspots, or only non-hotspots (with customizable palette).
Supports quantile "stretch" globally (per service) or locally (per facet).
}
}
